<mat-tab-group [(selectedIndex)]='tabIndex' class="detailTab" *ngIf="movie">

  <!--  Tab to show the general details of the movie -->
  <mat-tab label="General">
    <div class="bg-image" *ngIf="movie.backdrop_path"
         [ngStyle]="{'background-image': 'url(' + image + ')'}">
    </div>
    <div fxLayout="row" fxLayoutAlign="center center" class="cont">
      <div class="image_content">

        <!-- movie poster image -->
        <div *ngIf="movie.poster_path; then poster else noPoster"></div>

        <ng-template #poster>
          <img class="image" src="{{url_image_poster}}{{movie.poster_path}}" alt="{{movie.title}} poster">
        </ng-template>

        <ng-template #noPoster>
          <img class="image" src="assets/no-poster.jpg" alt="{{movie.title}} poster image">
        </ng-template>

      </div>

      <div class="details">

        <!-- Movie Title -->
        <div class="movieTitle">
          <span>
            <h2>{{movie.title}}</h2>
          </span>
        </div>

        <mat-divider></mat-divider>

        <div >
        <span>
          <!--<p>{{ (movie.overview.length > 500) ? (movie.overview | slice:0:100) + '....' : (movie.overview) }}</p>-->
          <p class="parrafo">{{movie.overview}}</p>
        </span>
        </div>

        <mat-divider></mat-divider>

        <!-- crew 
        <div *ngIf="movie.credits.crew.length > 0; else noCrewBlock" class="row" fxLayout="row wrap" fxLayoutAlign="space-around center" fxLayoutGap="20px">
        <div *ngFor="let person of movie.credits.crew | slice:0:8" layout="column">
          <a [routerLink]="['/person', person.id]" class="crew">
            <strong class="tc-white">{{person['name']}}</strong>
          </a> 
          <div>
            <a>{{person.name}}</a>
            <span>{{person.job}}</span>
          </div>
          
        </div>
      </div>-->

        <!-- Last Icons -->
        <ul class="icons">
          <li class="single_icon" *ngIf="movie.release_date">
            <div>
              <mat-icon>event</mat-icon>
            </div>
            <div class="text">Release <br>Date</div>
            <div>: {{movie.release_date}}</div>
          </li>
          <li class="single_icon" *ngIf="movie.runtime">
            <div>
              <mat-icon>access_time</mat-icon>
            </div>
            <div class="text">Duration</div>
            <div>
              : {{movie.runtime}} mins.
            </div>
          </li>
          <li class="single_icon" *ngIf="movie.revenue > 0">
            <div>
              <mat-icon>attach_money</mat-icon>
            </div>
            <div class="text">Revenue</div>
            <div>
              : {{movie.revenue | currency}}
            </div>
          </li>
        </ul>
        <ul class="icons">
          <li class="single_icon" *ngIf="movie.budget > 0">
            <div>
              <mat-icon>money_off</mat-icon>
            </div>
            <div class="text">Budget</div>
            <div>
              : {{movie.budget | currency}}
            </div>
          </li>
          <li class="single_icon" *ngIf="movie.homepage">
            <div>
              <mat-icon>home</mat-icon>
            </div>
            <div class="text">Home <br>Page</div>
            <div>
              : <a href="{{movie.homepage}}">Official Page</a>
            </div>
          </li>
        </ul>
    </div>
  </div>

  </mat-tab>

  <!--  Tab to show the Images of the movie -->
  <mat-tab label="Images" *ngIf="movie.images">
    <div *ngIf="movie.images.backdrops.length > 0; then backdropsTrue else elseBlock"></div>
    <ng-template #backdropsTrue>
      <h1>Backdrops</h1>
      <mat-grid-list layout="row" [cols]="breakpointBackdrops" (window:resize)="onResize($event)" rowHeight="4:2" gutterSize="5px" >
        <mat-grid-tile *ngFor="let backdrop of movie.images.backdrops; let i = index" [colspan]="1" [rowspan]="1">

          <mat-card class="movie">
            <img mat-card-image src="{{url_images_backdrops}}{{backdrop.file_path}}">
          </mat-card>


          <mat-grid-tile-footer>{{backdrop.width}} x {{backdrop.height}}</mat-grid-tile-footer>
        </mat-grid-tile>
      </mat-grid-list>
      <mat-divider></mat-divider>
    </ng-template>



    <div *ngIf="movie.images.backdrops.length > 0; then postersTrue else elseBlock"></div>
    <ng-template #postersTrue>
      <h1>Posters</h1>
      <mat-grid-list layout="row" [cols]="breakpointPosters" (window:resize)="onResize($event)" rowHeight="3:4" gutterSize="5px" >
        <mat-grid-tile *ngFor="let poster of movie.images.posters; let i = index" [colspan]="1" [rowspan]="1">

          <mat-card class="movie">
            <img mat-card-image src="{{url_images_backdrops}}{{poster.file_path}}">
          </mat-card>


          <mat-grid-tile-footer>{{poster.width}} x {{poster.height}}</mat-grid-tile-footer>
        </mat-grid-tile>
      </mat-grid-list>
    </ng-template>

  </mat-tab>

  <!--  Tab to show the cast of the movie -->
  <mat-tab label="Cast" *ngIf="movie.credits.cast.length > 0">
    <div *ngIf="movie.credits.cast.length > 0; then castTrue else elseBlock"></div>
    <ng-template #castTrue>
      <mat-grid-list layout="row" cols="5" rowHeight="2:2.6" gutterSize="5px" >
        <mat-grid-tile *ngFor="let person of movie.credits.cast; let i = index" [colspan]="1" [rowspan]="1">

          <mat-card class="movie">
            <img mat-card-image src="{{url_image_poster}}{{person.profile_path}}">
          </mat-card>


          <mat-grid-tile-footer>{{person.name}} as {{person.character}}</mat-grid-tile-footer>
        </mat-grid-tile>
      </mat-grid-list>
    </ng-template>
  </mat-tab>

  <!--  Tab to show the crew of the movie 
  <mat-tab label="Crew" *ngIf="movie.credits.crew.length > 0">

  </mat-tab>-->

  <!--  Tab to show the movies similar to this-->
  <mat-tab label="Similar" *ngIf="movie.similar.total_results > 0">
      <mat-grid-list  [cols]="breakpointPosters" (window:resize)="onResize($event)" gutterSize="5px" rowHeight="3:4">
          <!--<mat-grid-list cols="4" gutterSize="5px" rowHeight="3:4" >-->
              <mat-grid-tile *ngFor="let movieSimilar of movie.similar.results" [colspan]="1" [rowspan]="1">
                  <mat-card class="movie" (click)="changeTab()" [routerLink]="['/movie', movieSimilar.id]" >
      
                      <!-- Poster Image -->
                      <div *ngIf="movieSimilar.poster_path; then truePoster else falsePoster"></div>
      
                      <ng-template #truePoster>
                          <img mat-card-image src="{{url_image_poster}}{{movieSimilar.poster_path}}">
                      </ng-template>
      
                      <ng-template #falsePoster>
                          <img mat-card-image  src="assets/no-poster.jpg">
                      </ng-template>
      
                  </mat-card>
              <mat-grid-tile-footer>{{movieSimilar.title}}</mat-grid-tile-footer>
              </mat-grid-tile>
      
          </mat-grid-list>


  </mat-tab>


</mat-tab-group>
